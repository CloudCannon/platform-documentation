{% macro nav(title) %}
    <nav id="t-docs-nav" class="t-docs-nav" :class="isPageNavOpen ? 't-docs-nav t-docs-nav--open' : 't-docs-nav'" x-init="$getNavMemory?.()">
            <div class="t-docs-nav__heading">
                <h2>{{ title }}</h2>

                <button class="t-docs-nav__control" x-on:click="isPageNavOpen = true; $focusNav(true);" x-show="!isPageNavOpen" aria-label="Open docs menu">
                    <img src="/assets/img/expand.svg" inline>
                </button>
                <button class="t-docs-nav__control" x-on:click="isPageNavOpen = false; $focusNav(false);" x-show="isPageNavOpen" aria-label="Close docs menu">
                    <img src="/assets/img/close.svg" inline>
                </button>
            </div>

        <ol class="t-docs-nav__main-list">
            <li class="t-docs-nav__main-list__item changelog-nav" >
                <span class="t-docs-nav__main-list__item__heading">Most recent</span>
                <div class="changelog-count">3</div>
            </li>

            {% set years = changelog_years() %}
            
            {% for year in years.keys %}
                <li class="t-docs-nav__main-list__item changelog-nav" >
                    <span class="t-docs-nav__main-list__item__heading">{{ year }}</span>
                    <div class="changelog-count">{{ years[year] }}</div>
                </li>
            {% endfor %}
        </ol>
        <div x-intersect="more = false" x-intersect:leave="more = true"></div>
    </nav>
    <!--<div class="t-docs-nav__base" :data-show="more">
        <img src="/assets/img/arrow.svg" class="t-docs-nav__base__icon" inline>
    </div>-->
{% endmacro %}

{% macro subnav(block) %}
    <ol class="t-docs-nav__sub-list">
        {% for item in block.items %}
            {% if item._type == "group" %}
                <li>
                    <details {% if url in item._bubbled %}open{% endif %}>
                        <summary class="t-docs-nav__sub-list__heading">
                            {{ item.name }}
                            <img src="/assets/img/arrow.svg" class="t-docs-nav__sub-list__heading__arrow" inline>
                        </summary>
                        {{ subnav(item) }}
                    </details>
                </li>
            {% else %}
                {% for article in item.articles %}
                    {% if article === 'index' %}
                        {% set article_page = search.page("url=/documentation/articles/") %}
                    {% else %}
                        {% if article === 'beta' %}
                            {% set article_page = search.page("url=/documentation/articles/beta/") %}
                        {% else %}
                            {% set article_page = search.page("url=/documentation/articles/"+article+"/") %}
                        {% endif %}
                    {% endif %}
                    
                    {% if article_page %}
                    <li>
                        <a class="t-docs-nav__sub-list__article"
                            {% if article_page.url == url %} aria-current="page"{% endif %}
                            href="{{ article_page.url }}"
                            @click="$setNavMemory?.()">
                            {{ article_page.page.data.nav_title }}
                        </a>
                    </li>
                    {% endif %}
                {% endfor %}
            {% endif %}
        {% endfor %}
    </ol>
{% endmacro %}
